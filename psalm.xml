<?xml version="1.0"?>
<psalm
    runTaintAnalysis="true"
>
    <projectFiles>
        <directory name="ajax" />
        <directory name="front" />
        <directory name="inc" />
        <directory name="install" />
        <directory name="src" />

        <ignoreFiles>
            <!-- Psalm gets stuck on TCPDF analysis, must be ignored for now -->
            <file name="src/Glpi/Search/Output/Tcpdf.php" />
        </ignoreFiles>
    </projectFiles>

    <issueHandlers>
        <!-- Suppress some errors for now, to make the report readable and handle error type one by one -->
        <TaintedCallable errorLevel="suppress" />
        <TaintedCookie errorLevel="suppress" />
        <TaintedFile errorLevel="suppress" />
        <!-- <TaintedHeader errorLevel="suppress" /> -->
        <!-- <TaintedHtml errorLevel="suppress" /> -->
        <TaintedInclude errorLevel="suppress" />
        <TaintedLdap errorLevel="suppress" />
        <TaintedSSRF errorLevel="suppress" />
        <TaintedSql errorLevel="suppress" />
        <!-- <TaintedTextWithQuotes errorLevel="suppress" /> -->
    </issueHandlers>
</psalm>
